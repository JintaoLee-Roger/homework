\documentclass{article}

\usepackage[UTF8, scheme = plain]{ctex}
\usepackage{fancyhdr}
\usepackage{extramarks}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{tikz}
\usepackage[plain]{algorithm}
\usepackage{algpseudocode}
\usepackage{color}
\usepackage{listings}
\usepackage{fontspec}

% \newfontfamily\menlo{Menlo}
\newfontfamily\menlo{Consolas}
\lstset{
    columns=fixed,       
    numbers=left,                                        % 在左侧显示行号
    numberstyle=\tiny\color{gray},                       % 设定行号格式
    frame=none,                                          % 不显示背景边框
    backgroundcolor=\color[RGB]{245,245,244},            % 设定背景颜色
    keywordstyle=\color[RGB]{40,40,255},                 % 设定关键字颜色
    numberstyle=\footnotesize\color{darkgray},           
    commentstyle=\it\color[RGB]{0,96,96},                % 设置代码注释的格式
    stringstyle=\rmfamily\slshape\color[RGB]{128,0,0},   % 设置字符串格式
    showstringspaces=true,                              % 不显示字符串中的空格
    numberstyle=\small\menlo,
    basicstyle=\small\menlo,
    breaklines=true,
}

% \lstset{
%     language=Octave,                % the language of the code
%     basicstyle=\footnotesize,           % the size of the fonts that are used for the code
%     numbers=left,                   % where to put the line-numbers
%     numberstyle=\tiny\color{gray},  % the style that is used for the line-numbers
%     stepnumber=1,                   % the step between two line-numbers. If it's 1, each line 
%                                     % will be numbered
%     numbersep=5pt,                  % how far the line-numbers are from the code
%     backgroundcolor=\color{white},      % choose the background color. You must add \usepackage{color}
%     showspaces=false,               % show spaces adding particular underscores
%     showstringspaces=false,         % underline spaces within strings
%     showtabs=false,                 % show tabs within strings adding particular underscores
%     frame=single,                   % adds a frame around the code
%     rulecolor=\color{black},        % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. commens (green here))
%     tabsize=2,                      % sets default tabsize to 2 spaces
%     captionpos=b,                   % sets the caption-position to bottom
%     breaklines=true,                % sets automatic line breaking
%     breakatwhitespace=false,        % sets if automatic breaks should only happen at whitespace
%     title=\lstname,                 % show the filename of files included with \lstinputlisting;
%                                     % also try caption instead of title
%     keywordstyle=\color{blue},          % keyword style
%     commentstyle=\color{dkgreen},       % comment style
%     stringstyle=\color{mauve},         % string literal style
%     escapeinside={\%*}{*)},            % if you want to add LaTeX within your code
%     morekeywords={*,...}               % if you want to add more keywords to the set
% }

\usetikzlibrary{automata,positioning}

%
% Basic Document Settings
%
%%% page layout
\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in

\linespread{1.1}    %%% line spacing

\definecolor{ustcblue}{cmyk}{1,0.8,0,0}

\pagestyle{fancy}
\lhead{\hmwkAuthorName}
\chead{\hmwkClass\ (\hmwkClassInstructor): \hmwkTitle}
\rhead{}
\lfoot{}
\cfoot{\thepage}

\renewcommand\headrulewidth{0.4pt}
\renewcommand\footrulewidth{0.4pt}

\setlength\parindent{0pt}

%
% Create Problem Sections
%

\newcommand{\enterProblemHeader}[1]{
    \nobreak\extramarks{}{Problem \arabic{#1} continued on next page\ldots}\nobreak{}
    \nobreak\extramarks{Problem \arabic{#1} (continued)}{Problem \arabic{#1} continued on next page\ldots}\nobreak{}
}

\newcommand{\exitProblemHeader}[1]{
    \nobreak\extramarks{Problem \arabic{#1} (continued)}{Problem \arabic{#1} continued on next page\ldots}\nobreak{}
    \stepcounter{#1}
    \nobreak\extramarks{Problem \arabic{#1}}{}\nobreak{}
}

\setcounter{secnumdepth}{0}
\newcounter{partCounter}
\newcounter{homeworkProblemCounter}
\setcounter{homeworkProblemCounter}{1}
\nobreak\extramarks{Problem \arabic{homeworkProblemCounter}}{}\nobreak{}

%
% Homework Problem Environment
%
% This environment takes an optional argument. When given, it will adjust the
% problem counter. This is useful for when the problems given for your
% assignment aren't sequential. See the last 3 problems of this template for an
% example.
%
\newenvironment{homeworkProblem}[1][-1]{
    \ifnum#1>0
        \setcounter{homeworkProblemCounter}{#1}
    \fi
    \subsection{Exercise \arabic{homeworkProblemCounter}}
    \setcounter{partCounter}{1}
    \enterProblemHeader{homeworkProblemCounter}
}{
    \exitProblemHeader{homeworkProblemCounter}
}

%
% Homework Details
%   - Title
%   - Due date
%   - Class
%   - Section/Time
%   - Instructor
%   - Author
%

\newcommand{\hmwkTitle}{Homework\ \#1}
\newcommand{\hmwkDueDate}{\today}
\newcommand{\hmwkClass}{Solid Mechanics}
\newcommand{\hmwkClassInstructor}{Professor Z. Wu}
\newcommand{\hmwkAuthorName}{\textbf{Jintao Li}}
\newcommand{\hmwkAuthorID}{\textbf{SA20007037}}
\newcommand{\hmwkAuthoremail}{\textbf{E-mail: lijintao@mail.ustc.edu.cn}}

%
% Title Page
%

% \title{
%     \vspace{2in}
%     \textbf{\hmwkClass:\ \hmwkTitle}\\
%     \normalsize\vspace{0.2in}\large{\hmwkDueDate}\\
%     \vspace{0.2in}\large{\textit{\hmwkClassInstructor}}
%     \vspace{3in}
% }

% \author{\hmwkAuthorName \\
% \hmwkAuthorID}
% \date{}

\renewcommand{\part}[1]{\textbf{ \\ (\alph{partCounter})  }\stepcounter{partCounter} }

%
% Various Helper Commands
%

% Useful for algorithms
\newcommand{\alg}[1]{\textsc{\bfseries \footnotesize #1}}

% For derivatives
\newcommand{\deriv}[1]{\frac{\mathrm{d}}{\mathrm{d}x} (#1)}

% For partial derivatives
\newcommand{\pderiv}[2]{\frac{\partial}{\partial #1} (#2)}

% Integral dx
\newcommand{\dx}{\mathrm{d}x}

% Alias for the Solution section header
\newcommand{\solution}{\textbf{\large \\ Solution: \\}}

% Probability commands: Expectation, Variance, Covariance, Bias
\newcommand{\E}{\mathrm{E}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\Cov}{\mathrm{Cov}}
\newcommand{\Bias}{\mathrm{Bias}}

%
\newcommand{\mb}[1]{\mathbf{#1}}

\begin{document}

\begin{titlepage}

\begin{center}

\textcolor{ustcblue}{\includegraphics[width=0.25\textwidth]{./ustc_logo_fig.pdf} \\ [1cm]}
% Title
{ \Huge \bfseries \hmwkClass\ \hmwkTitle}\\[1cm]

\large \textbf{\hmwkClassInstructor} \\ [5cm]

\large \hmwkAuthorName \\ [0.25cm]
\large \hmwkAuthorID \\ [0.25cm]
\large \hmwkAuthoremail
\vfill
% Bottom of the page
{\large November 15, 2020}

\end{center}

\end{titlepage}

\begin{center}
\section{Chapter 1 应力分析}
\end{center}

\begin{homeworkProblem}[1]
求地幔楔中应力的分布，假设板块的俯冲速度为 5 cm/year, 俯冲角度为 30 度,地幔楔的粘度为 $10^{20}$ Pa/s。
\begin{figure}[htb]
    \centering
    \includegraphics[width=6in, keepaspectratio]{hw1/prob.png}
    \label{fig:pro}
\end{figure}

步骤：

1. 给定板块俯冲速度，可以得到地幔楔中的速度和压强分布；

2. 使用速度分布，求偏微分，得到偏应力张量的分量；

3. 根据得到的张量，求出各点的主应力的大小和方向，以及各点最大剪应力的大小，作图表示。\\


要求：

1. 给出公式和简要计算过程；

2. 图画到300公里深度以内，最大剪应力的大小使用颜色表示（画出色标）， 
主应力的大小和方向使用十字架表示（画出线段长度的比例）。

\solution

\subsubsection{1. 求出流函数的常数，由此可知速度分布和压强分布}
参考书籍 \textit{Geodynamics}，图中的拐角流函数可以写成以下形式：
\begin{equation}
    \psi=(A x+B y)+(C x+D y) \arctan \frac{y}{x} .
\end{equation}
其速度为：
\begin{equation}
    u= - \frac{\partial \psi}{\partial y}  = -B-D \arctan \frac{y}{x}+(C x+D y)\left(\frac{-x}{x^{2}+y^{2}}\right)
\end{equation}

\begin{equation}
    v= \frac{\partial \psi}{\partial x} = A+C \arctan \frac{y}{x}+(C x+D y)\left(\frac{-y}{x^{2}+y^{2}}\right)
\end{equation}

\begin{figure}[htb]
    \centering
    \includegraphics[width=6in, keepaspectratio]{hw1/fig1.pdf}
    \caption{示意图}
    \label{fig:fig1}
\end{figure}

建立坐标如图~\ref{fig:fig1} 所示，边界条件：
对于地幔楔上覆板块部分，在 $y = 0, x > 0$ 处，有 $u = v = 0$，代入方程中得到： 
\begin{equation}
    B = -C, \  A = 0
\end{equation}
在 $y = x\tan\theta$ 处，有 
$u = U\cos\theta = \frac{\sqrt{3}}{2} U, v = U\sin\theta = \frac{1}{2} U$，
代入方程中得到
\begin{equation}
    \begin{aligned}
    -B - \frac{3}{4}C - (\frac{\pi}{6} + \frac{\sqrt{3}}{4})D = \frac{\sqrt{3}}{2}U ,\\
    A + (\frac{\pi}{6} - \frac{\sqrt{3}}{4})C - \frac{1}{4}D = \frac{1}{2}U .
    \end{aligned}
\end{equation}
将这两处的边界条件结合可得：
\begin{equation}
    \begin{aligned}
        & A = 0 , \\
        & B = -C , \\
        & \frac{1}{4}C - (\frac{\pi}{6} + \frac{\sqrt{3}}{4})D = \frac{\sqrt{3}}{2}U, \\
        & (\frac{\pi}{6} - \frac{\sqrt{3}}{4})C - \frac{1}{4}D = \frac{1}{2}U .
    \end{aligned}
\end{equation}

代入$U = 5 \ cm/year$， 可以解改方程组得到上覆板块的常数A1, B1, C1, D1。 \\

对于下冲板块部分，在 $y = 0, x > 0$ 处，有 $u = U, v = 0$，代入方程中得到：
\begin{equation}
    \begin{aligned}
    -B - C - \pi D = U, \\
    A + \pi C = 0
    \end{aligned}
\end{equation}
在 $y = \tan\theta x $ 处， 有 
$u = U\cos\theta = \frac{\sqrt{3}}{2} U, v = U\sin\theta = \frac{1}{2} U$，
代入方程中得到
\begin{equation}
    \begin{aligned}
    -B - \frac{3}{4}C - (\frac{\pi}{6} + \frac{\sqrt{3}}{4})D = \frac{\sqrt{3}}{2}U ,\\
    A + (\frac{\pi}{6} - \frac{\sqrt{3}}{4})C - \frac{1}{4}D = \frac{1}{2}U .
    \end{aligned}
\end{equation}
将这两处的边界条件结合可得：
\begin{equation}
    \begin{aligned}
        & A = -\pi C , \\
        & B = -C - \pi D - U , \\
        & \frac{1}{4}C - (\frac{\sqrt{3}}{4} - \frac{5\pi}{6})D = (\frac{\sqrt{3}}{2}-1)U, \\
        & -(\frac{\sqrt{3}}{4} + \frac{5\pi}{6})C - \frac{1}{4}D = \frac{1}{2}U .
    \end{aligned}
\end{equation}

代入$U = 5 \ cm/year$， 可以解改方程组得到下冲板块的常数A2, B2, C2, D2。\\

由此，两部分的流函数的常数以求出，参考书籍中的速度和压强公式可求出速度和压强分布：
\begin{equation}
    u=-B-D \arctan \frac{y}{x}+(C x+D y)\left(\frac{-x}{x^{2}+y^{2}}\right)
\end{equation}
\begin{equation}
    v=A+C \arctan \frac{y}{x}+(C x+D y)\left(\frac{-y}{x^{2}+y^{2}}\right)
\end{equation}
\begin{equation}
    P=\frac{-2 \mu(C x+D y)}{\left(x^{2}+y^{2}\right)}
\end{equation}
其中$\mu = 10^{20} \ Pa/s$是粘滞系数。

\subsubsection{2. 求偏应力张量的分量}
对于二维粘滞系数为常数的牛顿流体，其应力偏张量分量为：
\begin{equation}
    \begin{aligned}
    \tau_{x x} &=2 \mu \frac{\partial u}{\partial x} \\
    \tau_{y y} &=2 \mu \frac{\partial v}{\partial y} \\
    \tau_{y x} &=\tau_{x y}=\mu\left(\frac{\partial u}{\partial y}+\frac{\partial v}{\partial x}\right)
    \end{aligned}
\end{equation}

\subsubsection{3. 求应力分布}

其主应力为 $\sigma_0 = P$，所以其应力张量分量为：
\begin{equation}
    \begin{aligned}
    \sigma_{x x} &=P-\tau_{x x}=P-2 \mu \frac{\partial u}{\partial x} \\
    \sigma_{y y} &=P-\tau_{y y}=P-2 \mu \frac{\partial v}{\partial y} \\
    \sigma_{x y} &= \sigma_{y x} = \tau_{y x} = \mu\left(\frac{\partial u}{\partial y}+\frac{\partial v}{\partial x}\right)
    \end{aligned}
\end{equation}

最大、最小主应力为：
\begin{equation}
    \left\{ \begin{matrix}
        \sigma_1 \\ \sigma_2
    \end{matrix} \right\} = \frac{\sigma_{xx} + \sigma_{yy}}{2} \pm 
    \sqrt{(\frac{\sigma_{xx}-\sigma_{yy}}{2})^2 + \sigma_{xy}^2}
\end{equation}

最大剪应力为：
\begin{equation}
    \tau_{max} = \pm (\frac{\sigma_1 - \sigma_2}{2})
\end{equation}

方向夹角：
\begin{equation}
    \alpha = \frac{1}{2} \arctan (\frac{\sigma_{yy} - \sigma_{xx}}{2\sigma_{xy}})
\end{equation}

最大主应力与x轴夹角为 $\alpha$，最小主应力与x轴夹角为 $\frac{\pi}{2} - \alpha$，
剪应力方向为 $\frac{\pi}{4} - \alpha$

\subsubsection{4. 结果}
\begin{figure}[htb]
    \centering
    \includegraphics[width=4in, keepaspectratio]{hw1/result1.eps}
    \label{fig:fig1}
\end{figure}
\begin{figure}[htb]
    \centering
    \includegraphics[width=4in, keepaspectratio]{hw1/result2.eps}
    \label{fig:fig1}
\end{figure}

\subsubsection{5. Code}
见附件

\end{homeworkProblem}


\end{document}
